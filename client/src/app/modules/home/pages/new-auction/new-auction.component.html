<div class="w-90-center">
  <h2 class="pt-4 ext-left ml-2"> {{'newAuction.start' | translate}}</h2>
  <form #f="ngForm" (ngSubmit)="f.form.valid && checkName() && saveAuction()" novalidate class="feedback-form"
        autocomplete="off">
    <mat-card>

      <div class="form-group">
        <label>{{'newAuction.title' | translate}}</label>
        <input type="text"
               id="title"
               class="form-control w-50"
               name="title"
               [(ngModel)]="auction.title"
               required minlength="5"
               required maxlength="40"
               #title="ngModel"
               [ngClass]="{ 'is-invalid': f.submitted && title.invalid }"
               required/>
        <!-- input validation group -->
        <div *ngIf="f.submitted && title.invalid" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="title.errors?.required">{{'register.isEmpty' | translate}}</div>
          <div *ngIf="title.errors?.minlength">{{'register.toSmall5' | translate}}</div>
        </div>
      </div>

      <div class="form-group">
        <label>{{'newAuction.category' | translate}}</label><br>
        <mat-select class="form-control w-50"
                    [(ngModel)]="auction.category"
                    name="category"
                    #category="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && category.invalid }"
                    required>
          <mat-option *ngFor="let category of categories" [value]="category">{{category}}</mat-option>
        </mat-select>
        <div *ngIf="f.submitted && category.invalid" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="category.errors?.required">{{'register.isEmpty' | translate}}</div>
        </div>
      </div>

      <div class="form-group">
        <label>{{'newAuction.price' | translate}}</label>
        <input class="form-control w-25 text-right"
               [(ngModel)]="auction.price"
               type="number"
               placeholder="0"
               name="price">
      </div>

      <div class="form-group">
        <label>{{'newAuction.condition' | translate}}</label><br>
        <mat-select class="form-control w-25"
                    [(ngModel)]="auction.condition"
                    name="condition"
                    #condition="ngModel"
                    [ngClass]="{ 'is-invalid': f.submitted && condition.invalid }"
                    required>
          <mat-option *ngFor="let condition of conditions" [value]="condition">{{condition}}</mat-option>
        </mat-select>
        <div *ngIf="f.submitted && condition.invalid" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="condition.errors?.required">{{'register.isEmpty' | translate}}</div>
        </div>
      </div>

    </mat-card>

    <app-dynamic-panel *ngIf="auction.category" [category]="auction.category"
                       (selectEmitter)="receiveSelectedData($event)"></app-dynamic-panel>

    <mat-card>
      <div class="form-group w-50">
        <label for="comment">{{'newAuction.description' | translate}}</label>
        <textarea class="form-control"
                  rows="7"
                  id="comment"
                  required minlength="5"
                  required maxlength="600"
                  #description="ngModel"
                  [(ngModel)]="auction.description"
                  [ngClass]="{ 'is-invalid': f.submitted && description.invalid }"
                  name="description" required></textarea>
        <div *ngIf="f.submitted && description.invalid" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="description.errors?.required">{{'register.isEmpty' | translate}}</div>
          <div *ngIf="description.errors?.minlength">{{'register.toSmall5' | translate}}</div>
        </div>
      </div>
    </mat-card>

    <mat-card>
      <label>{{'newAuction.contactData' | translate}}</label>
      <div class="form-group mt-2">
        <label>{{'newAuction.city' | translate}}</label>
        <input class="form-control w-50"
               autocomplete="off"
               ngx-google-places-autocomplete
               [options]='options'
               name="input"
               placeholder="{{'newAuction.setCity' | translate}}"
               #placesRef="ngx-places"
               #city="ngModel"
               [(ngModel)]="cityName"
               (onAddressChange)="handleAddressChange($event)"
               [ngClass]="{ 'is-invalid': f.submitted && email.invalid }"
               required/>
        <div *ngIf="f.submitted && (city.invalid || !checkName())" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="city.errors?.required">{{'register.isEmpty' | translate}}</div>
          <div *ngIf="!checkName()">{{'register.cityIsNotProvideByGoogle' | translate}}</div>
        </div>
      </div>
      <div class="form-group">
        <label>{{'newAuction.email' | translate}}</label>
        <input type="text"
               id="email"
               class="form-control w-50"
               name="email"
               [(ngModel)]="auction.email"
               #email="ngModel"
               [ngClass]="{ 'is-invalid': f.submitted && email.invalid }"
               required email/>
        <!-- input validation group -->
        <div *ngIf="f.submitted && email.invalid" class="invalid-input mt-2">
          <!-- individual validation errors -->
          <div *ngIf="email.errors?.required">{{'register.isEmpty' | translate}}</div>
          <div *ngIf="email.errors?.minlength">{{'register.toSmall5' | translate}}</div>
        </div>
      </div>

      <div class="form-group">
        <label>{{'register.urName' | translate}}</label>
        <input class="form-control w-25" [(ngModel)]="name" name="name" disabled>
      </div>
      <div class="form-group">
        <label>{{'newAuction.phone' | translate}}</label>
        <input class="form-control w-25" [(ngModel)]="auction.phone" name="phone">
      </div>
    </mat-card>

    <mat-card class="h-100">
      <div class="w-100" #div [ngStyle]="{'height.px': div.offsetWidth / 5}">
        <app-drag-drop class="h-100" [maxAmountOfImages]="maxSizeOfImages"
                       (filesEmitter)="receiveImages($event)"></app-drag-drop>
      </div>
      <div class="row">
        <div class="col-3" *ngFor="let number of [0,1,2,3]">

          <div #div1 *ngIf="selected!=number">
            <mat-card [ngStyle]="{'height.px': div1.offsetWidth}" class="w-100" (click)="selectMainPhoto(number)">
              <app-image *ngIf="previewUrl[number]" [path]="previewUrl[number]"></app-image>
              <fa-icon *ngIf="previewUrl[number]" class="removeImage" [icon]="faRemove"></fa-icon>
            </mat-card>
          </div>

          <div #div2 class="selected" *ngIf="selected == number && previewUrl[number]">
            <mat-card [ngStyle]="{'height.px': div2.offsetWidth}" class="w-100" (click)="selectMainPhoto(number)">
              <app-image *ngIf="previewUrl[number]" [path]=previewUrl[number]></app-image>
              <fa-icon *ngIf="previewUrl[number]" class="removeImage" [icon]="faRemove" (click)="removeImage(number)"></fa-icon>
            </mat-card>
          </div>

        </div>
      </div>
    </mat-card>
    <div class="row">
      <div class="col-3"></div>
      <div class="col-6">
        <mat-card (click)="f.onSubmit($event)" class="submit text-center font-weight-bold">
          <label>{{'newAuction.save' | translate}}</label>
        </mat-card>
      </div>
      <div class="col-3"></div>
    </div>
  </form>
</div>
